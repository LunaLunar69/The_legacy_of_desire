[gd_scene load_steps=13 format=3 uid="uid://bw0atc0j3jsdm"]

[ext_resource type="Texture2D" uid="uid://qwy7r4rdwrsg" path="res://Assets/Sprites/chadWalkingBack/2.png" id="2_4qjco"]
[ext_resource type="Texture2D" uid="uid://c1rx5so1ylcre" path="res://Assets/Sprites/chadWalkingSide/1.png" id="3_smhpm"]
[ext_resource type="Texture2D" uid="uid://cdk6ulbaw4avw" path="res://Assets/Sprites/chadWalkingFront/1.png" id="4_am38o"]
[ext_resource type="Texture2D" uid="uid://j73w770cj17r" path="res://Assets/Sprites/chadWalkingBack/1.png" id="5_dw42r"]
[ext_resource type="Texture2D" uid="uid://duum4uh8ax3d4" path="res://Assets/Sprites/chadWalkingBack/3.png" id="6_y7see"]
[ext_resource type="Texture2D" uid="uid://bljus7ylc0ew8" path="res://Assets/Sprites/chadWalkingFront/2.png" id="7_awxwk"]
[ext_resource type="Texture2D" uid="uid://c4awfyd4p7bou" path="res://Assets/Sprites/chadWalkingFront/3.png" id="8_u0bhs"]
[ext_resource type="Texture2D" uid="uid://bo50f1u251kid" path="res://Assets/Sprites/chadWalkingSide/2.png" id="9_vga1d"]
[ext_resource type="Texture2D" uid="uid://c56atgay6us22" path="res://Assets/Sprites/chadWalkingSide/3.png" id="10_aqnvw"]

[sub_resource type="GDScript" id="GDScript_setn8"]
script/source = "extends CharacterBody2D

# --- Variables Exportadas y Constantes ---
@export var SPEED: float = 250.0 # Velocidad configurable desde el Inspector
@onready var animated_sprite: AnimatedSprite2D = $AnimatedSprite2D

# Define los nombres de las animaciones que tienes en tu SpriteFrames:
const ANIM_WALK_BACK := \"walkfront\" # Para caminar hacia ARRIBA
const ANIM_WALK_FRONT := \"walkback\" # Para caminar hacia ABAJO
const ANIM_WALK_SIDE := \"walkside\" # Para caminar a los lados (usaremos flip_h para izquierda)
const ANIM_IDLE := \"walkfront\" # Usaremos la primera frame de \"walkfront\" para la inactividad

# --- Lógica de Movimiento ---

func _physics_process(delta: float) -> void:
	# 1. Obtener la entrada del usuario
	var input_vector: Vector2 = Input.get_vector(\"ui_left\", \"ui_right\", \"ui_up\", \"ui_down\")
	
	if input_vector != Vector2.ZERO:
		# Si hay movimiento, normalizamos y aplicamos velocidad
		velocity = input_vector.normalized() * SPEED
		
		# 2. Llamamos a la función para gestionar las animaciones
		_update_animations(input_vector)
	else:
		# Si no hay movimiento, detenemos la velocidad y establecemos la animación de inactividad
		velocity = Vector2.ZERO
		_update_idle_state()

	# 3. Mover el personaje
	move_and_slide()


# --- Función de Gestión de Animaciones ---

func _update_animations(input_vector: Vector2) -> void:
	# Comprobamos la dirección principal para decidir qué animación reproducir:
	
	if abs(input_vector.x) > abs(input_vector.y):
		# Movimiento Horizontal (Lados)
		animated_sprite.animation = ANIM_WALK_SIDE
		
		# Determinar la dirección horizontal y voltear el sprite (Flip H):
		if input_vector.x > 0:
			# Derecha
			animated_sprite.flip_h = false
		else:
			# Izquierda
			animated_sprite.flip_h = true
	
	else:
		# Movimiento Vertical (Arriba/Abajo)
		animated_sprite.flip_h = false # Quitamos el flip
		
		if input_vector.y > 0:
			# Abajo
			animated_sprite.animation = ANIM_WALK_FRONT
		else:
			# Arriba
			animated_sprite.animation = ANIM_WALK_BACK
			
	# Aseguramos que la animación se esté reproduciendo
	animated_sprite.play()


# --- Función para Inactividad ---

func _update_idle_state() -> void:
	# Si el personaje está inactivo, establecemos la animación IDLE.
	# Aquí usamos \"walkfront\" pero detenemos la reproducción
	if animated_sprite.animation != ANIM_IDLE:
		animated_sprite.animation = ANIM_IDLE
		
	# Detenemos la animación y forzamos el Frame 0 (posición de reposo)
	animated_sprite.stop()
	animated_sprite.frame = 0
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_setn8"]
size = Vector2(50.999996, 38)

[sub_resource type="SpriteFrames" id="SpriteFrames_dts1y"]
animations = [{
"frames": [],
"loop": true,
"name": &"attack",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_smhpm")
}, {
"duration": 1.0,
"texture": ExtResource("4_am38o")
}, {
"duration": 1.0,
"texture": ExtResource("5_dw42r")
}],
"loop": true,
"name": &"idle",
"speed": 3.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("2_4qjco")
}, {
"duration": 1.0,
"texture": ExtResource("6_y7see")
}],
"loop": true,
"name": &"walkback",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("7_awxwk")
}, {
"duration": 1.0,
"texture": ExtResource("8_u0bhs")
}],
"loop": true,
"name": &"walkfront",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("9_vga1d")
}, {
"duration": 1.0,
"texture": ExtResource("10_aqnvw")
}],
"loop": true,
"name": &"walkside",
"speed": 5.0
}]

[node name="Chad" type="CharacterBody2D"]
script = SubResource("GDScript_setn8")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(341.5, 82)
shape = SubResource("RectangleShape2D_setn8")

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(340.4216, 19.212116)

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
position = Vector2(343, 68.00001)
scale = Vector2(0.66289747, 0.5664394)
sprite_frames = SubResource("SpriteFrames_dts1y")
animation = &"walkback"
frame_progress = 0.8289305
